# Bash.im Reader for Android (Russian) 

Простая читалка цитат и комиксов с Bash.im для Android 4.0.3 и выше. Обращается к соответствующим страницам сайта, парсит их и показывает в виде списка или формате комикса. Я написал её для себя.

Для работы приложения необходимо подключение к Интернету. Голосовать за цитаты пока нельзя, но зато можно смотреть картинки - чего нет во многих других клиентах :)
  
## Библиотеки

1. [Retrofit 2.0](http://square.github.io/retrofit/) - для обращения к сайту
2. [JSoup 1.8](http://jsoup.org/) - для парсинга HTML 
3. [Picasso 2.5](http://square.github.io/picasso/) - для загрузки комиксов

## Архитектура
В качестве клиент-серверной модели за основу была взят проект, описанный в этой статье на Хабре - [Android архитектура клиент-серверного приложения] (https://habrahabr.ru/company/e-Legion/blog/265405/).

Причины выбора - разделение на модули, удобные для адаптации в других клиент-серверных приложениях. Я уже попробовал и убедился, что адаптация под другое API и другую модель объектов происходит достаточно быстро - не больше часа даже для меня (в случае одного запроса к другому серверу с другим протоколом с JSON-моделью).

Я не стал реализовывать абстрактную модель "ответа", как предлагается в статье, но в работе убедился, что такая модель полезна для адаптации под другие проекты, так как при изменение конкретной модели ответа требует дополнительной правки в методах и классах, связанных с лоадерами.

## Парсер HTML
Самая сложная и хрупкая часть - это парсер обычных HTML-страниц. В случае изменение формата страниц на Bash.im возможны ошибки парсинга. Я постарался, насколько возможно, обезопасить приложение от поломки и вылета. Так, если парсер не найдет данные по следующей странице - кнопки по ним просто не должны появиться.

В парсере используется библиотека JSoup - выбрана за популярность и удобный синтаксис, напоминающий привычный мне JQuery.

## ResizableImageView
 
Для показа комиксов используется ResizableImageView - класс, модифицирующий стандартный ImageView. Он пропорционально адаптирует размеры картинки по доступной в данном дизайне ширине. 

Источник кода - [StackOverflow: Android ImageView adjusting parent's height and fitting width] (http://stackoverflow.com/questions/5554682/android-imageview-adjusting-parents-height-and-fitting-width).  Я лишь немного отрефакторил те строчки (выделил переменные), чтобы лучше понимать внутреннюю механику пересчёта.

## Swipe.java
Для навигации по страницам используется простая симуляция свайпа через обработчик OnTouch на списке цитат и картинке в комиксах. 

## Планы

1. Добавить сохранение выбранных цитат в закладки (локальная база данных)
2. Расширить работу с базой данных до сохранения всех цитат для чтения в офлайне
3. Добавить функцию пересылки понравившейся цитаты по SMS, в буфер обмена и другие приложения
4. В комиксах сделать кликабельной ссылку на автора и на цитату (возможно, с прямой подгрузкой)